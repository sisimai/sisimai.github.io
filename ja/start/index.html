---
layout: document
directory: start/
title: Sisimaiのインストール・基本的な使い方
description: Sisimaiのインストール方法・システム環境・基本的な使い方と解析結果
author: azumakuniyuki
---

<a id = 'tohash' href = '#'></a>
<header id = 'home'>
    <div class = 'main-nav'>
        <div class = 'container'>
            <div class = 'navbar-header'>
                <button type = 'button' class = 'navbar-toggle' data-toggle = 'collapse' data-target = '.navbar-collapse'>
                    <span class = 'sr-only'>Toggle navigation</span>
                    <span class = 'icon-bar'></span>
                    <span class = 'icon-bar'></span>
                    <span class = 'icon-bar'></span>
                </button>
                <a class = 'navbar-brand' href = '/'>
                    <h1>
                        <img class = 'img-responsive' src = '/static/images/logo/sisimai-logotype-w11.png' 
                            width = '144' alt = 'Sisimai: Mail Analyzing Interface'>
                    </h1>
                </a>
            </div>
            <div class = 'collapse navbar-collapse'>
                <ul class = 'nav navbar-nav navbar-right'>
                    <li class = 'scroll'><a href = '/ja'><i class = 'fa fa-home'></i></a></li> 
                    <li class = 'scroll active'><a href = '#index'><i class = 'fa fa-arrow-circle-up'></i></a></li> 
                    <li class = 'scroll'><a href = '#environment'>動作環境</a></li>
                    <li class = 'scroll'><a href = '#install'>インストール</a></li> 
                    <li class = 'scroll'><a href = '#usage'>基本的な使い方</a></li>
                    <li class = 'others'><a href = '/ja/docs'>ドキュメント</a></li>
                    <li class = 'others'><a href = '/en/start'><i class = 'fa fa-language'></i></a></li>
                </ul>
            </div>
        </div>
    </div> <!-- /#main-nav -->
</header> <!-- /#home -->

<section id = 'index'>
    <div class = 'container'>
        <div class = 'heading'>
            <div class = 'row'>
                <div class = 'text-center col-sm-8 col-sm-offset-2'>
                    <img src = '/static/images/logo/sisimai-x01.png' width = '20%'>
                    <h2>シシマイを使ってみる</h2>
                </div>
            </div> 
        </div>
        <div class = 'text-center index-table'>
            <div class = 'row'>
                <div class = 'col-sm-3'>
                    <div class = 'index-icon'>
                        <i class = 'fa fa-desktop'></i>
                    </div>
                    <div class = 'index-info'>
                        <h3>動作環境</h3>
                        <hr>
                        <p class = 'description ja'>
                            {{ site.html.ss }}(シシマイ)はPerlまたはRuby (JRubyも含む) が動くOS
                            (ただしWindowsを除く) で動作します。
                        </p>
                    </div>
                    <a href = '#environment' class = 'btn btn-continue'>Read</a>
                </div>
                <div class = 'col-sm-3'>
                    <div class = 'index-icon'>
                        <i class = 'fa fa-cloud-download'></i>
                    </div>
                    <div class = 'index-info'>
                        <h3>インストール</h3>
                        <hr>
                        <p class = 'description ja'>
                            {{ site.html.ss }}はCPAN (Perl版)とRubyGems.org (Ruby版)、
                            そしてGitHub (Perl版とRuby版) からダウンロードできます。
                        </p>
                    </div>
                    <a href = '#install' class = 'btn btn-continue'>Read</a>
                </div>
                <div class = 'col-sm-3'>
                    <div class = 'index-icon'>
                        <i class = 'fa fa-keyboard-o'></i>
                    </div>
                    <div class = 'index-info'>
                        <h3>基本的な使い方</h3>
                        <hr>
                        <p class = 'description ja'>
                            バウンスメールの解析、構造化された解析済みデータの取得と
                            JSON化など簡単な使い方を紹介します。
                        </p>
                    </div>
                    <a href = '#usage' class = 'btn btn-continue'>Read</a>
                </div>
                <div class = 'col-sm-3'>
                    <div class = 'index-icon'>
                        <i class = 'fa fa-code'></i>
                    </div>
                    <div class = 'index-info'>
                        <h3>シシマイでの解析方法</h3>
                        <hr>
                        <p class = 'description ja'>
                            標準入力(STDIN)からの読み込み、配信成功も解析結果に含める方法、
                            コールバック機能で独自の処理を組み込む方法について。
                        </p>
                    </div>
                    <a href = '#usage' class = 'btn btn-continue'>Read</a>
                </div>
            </div>
        </div>
    </div>
</section> <!-- /#index -->

<section id = 'environment' class = 'parallax'>
    <div class = 'container'>
        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'post-it'>
                    <i class = 'fa fa-desktop'></i>
                </div>
            </div>
            <div class = 'heading col-sm-8 col-sm-offset-0'>
                <h2 class = 'in-desc'>動作環境</h2>
                <hr>
                <p class = 'description ja'>
                    {{ site.html.ss }}(シシマイ)は*BSDやMac OS XやLinuxのようなPerlまたは
                    Ruby(JRubyを含む)が動作するOSで動きます。
                    <a href = 'https://github.com/sisimai/p5-Sisimai/issues/53' target = 'new'>
                    しかしながら、現時点でWindowsでは動作しません。
                    </a>
                </p>
            </div>
        </div>
        <div class = 'text-center index-table'>
            <div class = 'row'>
                <div class = 'col-sm-4 col-sm-offset-2'>
                    <div class = 'spec-icon'>
                        <img src = '/static/images/icon/dinosaur-1.png'>
                        <h3 class = 'icon-caption'>Perl 5.10.1以上</h3>
                    </div>
                    <div class = 'index-info'>
                        <ul class = 'spec'>
                            <li>2つの依存モジュール </li>
                            <ul>
                                <li>
                                    <a href = 'https://metacpan.org/pod/Class::Accessor::Lite' target = 'new'>
                                        Class::Accessor::Lite
                                    </a>
                                </li>
                                <li><a href = 'https://metacpan.org/pod/JSON' target = 'new'>JSON</a></li>
                            </ul>
                            <li>幾つかのコアモジュール</li>
                            <ul>
                                <li title = 'Core module from Perl 5.9.4'>
                                    <a href = 'https://metacpan.org/pod/Module::Load' target = 'new'>Module::Load</a>
                                </li>
                                <li title = 'Core module from Perl 5.9.5'>
                                    <a href = 'https://metacpan.org/pod/Time::Piece' target = 'new'>Time::Piece</a>
                                </li>
                                <li title = 'Core module from Perl 5'>
                                    <a href = 'https://metacpan.org/pod/Time::Local' target = 'new'>Time::Local</a>
                                </li>
                            </ul>
                        </ul>
                        <a href = '{{ site.sisimai.distribution.perl }}' class = 'btn btn-continue'>CPANからダウンロード</a>
                    </div>
                </div>

                <div class = 'col-sm-4'>
                    <div class = 'spec-icon'>
                        <img src = '/static/images/icon/ruby-1.png'>
                        <h3 class = 'icon-caption'>Ruby 2.1.0以上</h3>
                    </div>
                    <div class = 'index-info'>
                        <ul class = 'spec'>
                            <li>JRuby 9.0.4.0以上でも可</li>
                            <li>依存ライブラリ(MRI)</li>
                            <ul>
                                <li>
                                    <a href = 'https://rubygems.org/gems/oj' target = 'new'>Oj</a>
                                </li>
                                <li></li>
                            </ul>
                            <li>依存ライブラリ(JRuby)</li>
                            <ul>
                                <li>
                                    <a href = 'https://rubygems.org/gems/jrjackson' target = 'new'>JrJackson</a>
                                </li>
                                <li></li>
                            </ul>
                        </ul>
                        <a href = '{{ site.sisimai.distribution.ruby }}' class = 'btn btn-continue'>RubyGemsからダウンロード</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section> <!-- /#environment -->

<section id = 'install'>
    <div class = 'container'>
        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'post-it'>
                    <i class = 'fa fa-cloud-download'></i>
                </div>
            </div>
            <div class = 'heading col-sm-8 col-sm-offset-0'>
                <h2 class = 'in-desc'>{{ site.html.ss }}をインストールする</h2>
                <p class = 'description'>
                    {{ site.html.ss }}はGitHub, CPAN, RubyGems.orgからそれぞれダウンロード・インストールが可能です。
                </p>
            </div>
        </div>
        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-label'><i class = 'fa fa-git'></i></div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h3 class = 'in-desc'>GitHubから</h3>
                <p class = 'description ja'>
                    <img class = 'lhs' src = '/static/images/icon/github-1.png'>
                    開発版を含む最新バージョンと安定版の{{ site.html.ss }}は
                    <a href = '{{ site.sisimai.repository.project }}' target = 'new'>GitHub</a>
                    のmasterブランチからダウンロード出来ます。Perl版・Ruby版ともに
                    このリポジトリにあります。
                </p>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-text'>Perl</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h4 class = 'in-desc'>Perl版{{ site.html.ss }}</h4>
                <p class = 'description ja'>
                    Perl版{{ site.html.ss }}のリポジトリ名は
                    <a href = '{{ site.sisimai.repository.perl }}'><strong>sisimai/p5-Sisimai</strong></a>
                    です。
                </p>
                <pre class = 'prettyprint'>
% <kbd>git clone https://github.com/sisimai/p5-Sisimai.git</kbd>
% <kbd>cd ./p5-Sisimai</kbd>
% <kbd>sudo make install-from-local</kbd>
--&gt; Working on .
Configuring Sisimai-4.14.2 ... OK
1 distribution installed
                </pre>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-text'>Ruby</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h4 class = 'in-desc'>Ruby版{{ site.html.ss }}</h4>
                <p class = 'description ja'>
                    Ruby版{{ site.html.ss }}のリポジトリ名は
                    <a href = '{{ site.sisimai.repository.ruby }}'><strong>sisimai/rb-Sisimai</strong></a>
                    です。
                </p>
                <pre class = 'prettyprint'>
% <kbd>git clone https://github.com/sisimai/rb-Sisimai.git</kbd>
% <kbd>cd ./rb-Sisimai</kbd>
% <kbd>sudo make depend install-from-local</kbd>
gem install bundle rake rspec coveralls
...
sisimai 4.14.2 built to pkg/sisimai-4.14.2.gem.
sisimai (4.14.2) installed.
                </pre>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-label'>Perl</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h3 class = 'in-desc'>CPANから</h3>
                <p class = 'description ja'>
                    <img class = 'lhs' src = '/static/images/icon/dinosaur-1.png'>
                    Perl版{{ site.html.ss }}の安定版のみ
                    <a href = '{{ site.sisimai.distribution.perl }}' target = 'new'>CPAN</a>
                    からダウンロードが可能です。<kbd>cpan</kbd>コマンドでもインストール出来ますが、
                    <a href = 'https://github.com/miyagawa/cpanminus' target = 'new'><kbd>cpanm</kbd></a>
                    コマンドを使うとPerlモジュールのインストールが非常に楽です。
                </p>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-8 col-sm-offset-2'>
                <pre class = 'prettyprint'>
% <kbd>sudo cpanm Sisimai</kbd>
--&gt; Working on Sisimai
Fetching http://www.cpan.org/authors/id/A/AK/AKXLIX/Sisimai-4.14.1.tar.gz ... OK
...
1 distribution installed
% <kbd>perldoc -l Sisimai</kbd>
/usr/local/lib/perl5/site_perl/5.20.0/Sisimai.pm
                </pre>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-label'>Ruby</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h3 class = 'in-desc'>RubyGems.orgから</h3>
                <p class = 'description ja'>
                    <img class = 'lhs' src = '/static/images/icon/ruby-1.png'>
                    Ruby版{{ site.html.ss }}の安定版のみ
                    <a href = '{{ site.sisimai.distribution.ruby }}' target = 'new'>RubyGems.org</a>
                    からダウンロードが可能で、<kbd>gem</kbd>コマンドでインストールが出来ます。
                    <br>
                    JRubyを使用する場合は<kbd>jgem</kbd>でのインストールも可能です。
                </p>
            </div>
        </div>
        <div class = 'row'>
            <div class = 'col-sm-8 col-sm-offset-2'>
                <pre class = 'prettyprint'>
% <kbd>sudo gem install sisimai</kbd>
Fetching: sisimai-4.14.2.gem (100%)
Successfully installed sisimai-4.14.2
Parsing documentation for sisimai-4.14.2
Installing ri documentation for sisimai-4.14.2
Done installing documentation for sisimai after 6 seconds
1 gem installed
                </pre>
            </div>
        </div>
    </div>
</section> <!-- /#install -->

<section id = 'usage' class = 'parallax'>
    <div class = 'container'>
        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'post-it'>
                    <i class = 'fa fa-keyboard-o'></i>
                </div>
            </div>
            <div class = 'heading col-sm-8 col-sm-offset-0'>
                <h2>基本的な使い方</h2>
            </div>
        </div>
        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-label'>make()</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h3 class = 'in-desc'>{{ site.html.ss }}のmake()メソッド</h3>
                <p class = 'description ja'>
                    <img class = 'lhs' src = '/static/images/icon/outline-1.png'>
                    下記のコードは{{ site.html.ss }}の<kbd>make()</kbd>
                    メソッドを使ってバウンスメールを解析し解析結果のデータを得る例です。
                    <kbd>make()</kbd>メソッドに指定できる他の引数については
                    <a href = '/ja/usage'>シシマイでの解析方法</a>をご覧ください。
                </p>
            </div>
        </div>
        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-text'>Perl</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h4 class = 'in-desc'>Perl版{{ site.html.ss }}</h4>
                <pre class = 'prettyprint'><span class = 'shebang'>#! /usr/bin/env perl</span>
use Sisimai;
my $v = Sisimai-&gt;make('/path/to/mbox'); # or Path to Maildir

if( defined $v ) {
    for my $e ( @$v ) {
        print $e-&gt;addresser-&gt;address;   # shironeko@example.org # From
        print $e-&gt;recipient-&gt;address;   # kijitora@example.jp   # To
        print $e-&gt;recipient-&gt;host;      # example.jp
        print $e-&gt;deliverystatus;       # 5.1.1
        print $e-&gt;replycode;            # 550
        print $e-&gt;reason;               # userunknown
    }
} else {
    # There is no bounce message in the mailbox
    # or Sisimai could not parse
}
                </pre>
            </div>
        </div>
        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-text'>Ruby</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h4 class = 'in-desc'>Ruby版{{ site.html.ss }}</h4>
                <pre class = 'prettyprint'><span class = 'shebang'>#! /usr/bin/env ruby</span>
require 'sisimai'
v = Sisimai.make('/path/to/mbox') # or Path to Maildir

if v.void
  # There is no bounce message in the mailbox
  # or Sisimai could not parse
else
  v.each do |e|
    puts e.addresser.address    # shironeko@example.org # From
    puts e.recipient.address    # kijitora@example.jp   # To
    puts e.recipient.host       # example.jp
    puts e.deliverystatus       # 5.1.1
    puts e.replycode            # 550
    puts e.reason               # userunknown
  end
end
                </pre>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-label'>dump()</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h3 class = 'in-desc'>{{ site.html.ss }}のdump()メソッド</h3>
                <p class = 'description ja'>
                    <img class = 'lhs' src = '/static/images/icon/purchase-order-1.png'>
                    Perl版{{ site.html.ss }} v4.1.27から登場した<kbd>dump()</kbd>メソッドは解析結果を
                    JSONで得るのに便利です。下記のように解析したいメールのPATHを渡すだけの
                    簡単なコードで済みます。
                </p>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-text'>Perl</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h4 class = 'in-desc'>Perl版{{ site.html.ss }}</h4>
                <pre class = 'prettyprint'><span class = 'shebang'>#! /usr/bin/env perl</span>
use Sisimai;
print Sisimai-&gt;dump('~/Maildir/cur');
                </pre>
            </div>

        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-text'>Ruby</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h4 class = 'in-desc'>Ruby版{{ site.html.ss }}</h4>
                <pre class = 'prettyprint'><span class = 'shebang'>#! /usr/bin/env ruby</span
require 'sisimai'
puts Sisimai.dump('~/Maildir/cur')
                </pre>
            </div>

        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-text'>Demo</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h4 class = 'in-desc'><strong>dump</strong>メソッドの使用例</h4>
                <img src = '/static/images/demo/sisimai-dump-01.gif' width = '100%'>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-label'>jq</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h3 class = 'in-desc'>&quot;jq&quot;コマンドと組み合わせる</h3>
                <p class = 'description ja'>
                    <img class = 'lhs' src = '/static/images/icon/js-1.png'>
                    解析結果のJSONデータを目で確認したい場合は
                    <a href = 'https://stedolan.github.io/jq/' target = 'new'><kbd>jq</kbd></a>コマンドが便利です。
                    下記のように<kbd>dump()</kbd>メソッドの出力が読みやすく表示されます。
                </p>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-text'>Perl</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h4 class = 'in-desc'>Perl版{{ site.html.ss }}</h4>
                <pre class = 'prettyprint'>
% <kbd>perl -MSisimai -lE 'print Sisimai-&gt;dump(shift)' path/to/mbox | jq .</kbd>
                </pre>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-text'>Ruby</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h4 class = 'in-desc'>Ruby版{{ site.html.ss }}</h4>
                <pre class = 'prettyprint'>
% <kbd>ruby -rsisimai -e 'puts Sisimai.dump($*.shift)' path/to/mbox | jq .</kbd>
                </pre>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-text'>Demo</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h4 class = 'in-desc'><strong>dump</strong>メソッドと<strong>jq</strong>の使用例</h4>
                <img src = '/static/images/demo/sisimai-dump-02.gif' width = '100%'>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-text'>JSON</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h4 class = 'in-desc'><strong>jq</strong>でJSONを見やすくした例</h4>
                <pre class = 'prettyprint'>
[
  {
    "smtpcommand": "DATA",
    "timestamp": 1397054085,
    "action": "failed",
    "listid": "",
    "reason": "hasmoved",
    "deliverystatus": "5.1.6",
    "smtpagent": "Sendmail",
    "destination": "example.net",
    "timezoneoffset": "+0900",
    "feedbacktype": "",
    "diagnostictype": "SMTP",
    "senderdomain": "example.co.jp",
    "rhost": "mx-s.neko.example.jp",
    "lhost": "localhost",
    "catch": "",
    "addresser": "shironeko@example.co.jp",
    "replycode": "551",
    "messageid": "0000000011111.fff0000000003@mx.example.co.jp",
    "token": "cf17945938502bd876603a375f0e9517c921bbab",
    "recipient": "kijitora@example.net",
    "alias": "",
    "diagnosticcode": "551 not our customer",
    "subject": "Nyaaaan",
    "softbounce": 0
  }
]
                </pre>
            </div>
        </div>
    </div>
</section> <!-- #usage -->

