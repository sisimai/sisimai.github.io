---
"layout": "document"
"directory": "start/"
"title": "Sisimaiのインストール・基本的な使い方"
"description": "Sisimaiのインストール方法・システム環境・基本的な使い方と解析結果"
"author": "azumakuniyuki"
---

<a id = 'tohash' href = '#'></a>
<header id = 'home'>
    <div class = 'main-nav'>
        <div class = 'container'>
            <div class = 'navbar-header'>
                <button type = 'button' class = 'navbar-toggle' data-toggle = 'collapse' data-target = '.navbar-collapse'>
                    <span class = 'sr-only'>Toggle navigation</span>
                    <span class = 'icon-bar'></span>
                    <span class = 'icon-bar'></span>
                    <span class = 'icon-bar'></span>
                </button>
                <a class = 'navbar-brand' href = '/'>
                    <h1>
                        <img class = 'img-responsive' src = '/static/images/logo/sisimai-logotype-w11.png' 
                            width = '144' alt = 'Sisimai: Mail Analyzing Interface'>
                    </h1>
                </a>
            </div>
            <div class = 'collapse navbar-collapse'>
                <ul class = 'nav navbar-nav navbar-right'>
                    <li class = 'scroll'><a href = '/ja'><i class = 'fa fa-home'></i></a></li> 
                    <li class = 'scroll active'><a href = '#index'><i class = 'fa fa-arrow-circle-up'></i></a></li> 
                    <li class = 'scroll'><a href = '#environment'>動作環境</a></li>
                    <li class = 'scroll'><a href = '#install'>インストール</a></li> 
                    <li class = 'scroll'><a href = '#usage'>基本的な使い方</a></li>
                    <li class = 'others'><a href = '/ja/docs/'>ドキュメント</a></li>
                    <li class = 'others'><a href = '/en/start/'><i class = 'fa fa-language'></i></a></li>
                    <li class = 'others'><a href = 'https://github.com/sisimai' target = 'new'><i class = 'fa fa-github'></i></a></li>
                </ul>
            </div>
        </div>
    </div> <!-- /#main-nav -->
</header> <!-- /#home -->

<section id = 'index'>
    <div class = 'container'>
        <div class = 'heading'>
            <div class = 'row'>
                <div class = 'text-center col-sm-8 col-sm-offset-2'>
                    <img src = '/static/images/logo/sisimai-x01.png' width = '20%'>
                    <h2>シシマイを使ってみる</h2>
                </div>
            </div> 
        </div>
        <div class = 'text-center index-table'>
            <div class = 'row'>
                <div class = 'col-sm-3'>
                    <div class = 'index-icon'>
                        <i class = 'fa fa-desktop'></i>
                    </div>
                    <div class = 'index-info'>
                        <h3>動作環境</h3>
                        <hr>
                        <p class = 'description ja'>
                            {{ site.html.ss }}(シシマイ)はPerlまたはRuby (JRubyの一部バージョンも含む)
                            あるいはGoでビルドしたバイナリが実行可能なシステムで動作します。
                        </p>
                    </div>
                    <a href = '#environment' class = 'btn btn-continue'>Read</a>
                </div>
                <div class = 'col-sm-3'>
                    <div class = 'index-icon'>
                        <i class = 'fa fa-cloud-download-alt'></i>
                    </div>
                    <div class = 'index-info'>
                        <h3>インストール</h3>
                        <hr>
                        <p class = 'description ja'>
                            {{ site.html.ss }}はCPAN (Perl版)とRubyGems.org (Ruby版)と、
                            そしてGitHub (Perl版/Ruby版/Go版) からダウンロードできます。
                            Go版は<kbd>go get</kbd>でもインストール可能です。
                        </p>
                    </div>
                    <a href = '#install' class = 'btn btn-continue'>Read</a>
                </div>
                <div class = 'col-sm-3'>
                    <div class = 'index-icon'>
                        <i class = 'fa fa-keyboard'></i>
                    </div>
                    <div class = 'index-info'>
                        <h3>基本的な使い方</h3>
                        <hr>
                        <p class = 'description ja'>
                            Maildir/やUNIX mboxにあるバウンスメールの解析、構造化された解析済みデータの取得と
                            各項目の参照方法、JSON化など簡単な使い方を紹介します。
                        </p>
                    </div>
                    <a href = '#usage' class = 'btn btn-continue'>Read</a>
                </div>
                <div class = 'col-sm-3'>
                    <div class = 'index-icon'>
                        <i class = 'fa fa-code'></i>
                    </div>
                    <div class = 'index-info'>
                        <h3>シシマイでの解析方法</h3>
                        <hr>
                        <p class = 'description ja'>
                            標準入力(STDIN)からの読み込み、配信成功や自動応答メッセージ(Vaction)も
                            解析結果に含める方法、コールバック機能で独自の処理を組み込む方法について。
                        </p>
                    </div>
                    <a href = '/ja/usage/' class = 'btn btn-continue'>Read</a>
                </div>
            </div>
        </div>
    </div>
</section> <!-- /#index -->

<section id = 'environment' class = 'parallax'>
    <div class = 'container'>
        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'post-it'>
                    <i class = 'fa fa-desktop'></i>
                </div>
            </div>
            <div class = 'heading col-sm-8 col-sm-offset-0'>
                <h2 class = 'in-desc'>動作環境</h2>
                <hr>
                <p class = 'description ja'>
                    {{ site.html.ss }}(シシマイ)は*BSDやmacOSやLinuxのようなPerlまたは
                    Ruby(JRubyを含む)、あるいはGoでビルドしたバイナリが動作するOSで動きます。
                </p>
                <p class = 'description ja'>
                    <strong>
                    {{ site.html.ss }} 5.0.0では、互換性のない破壊的な変更がいくつか入っています。
                    インストールやアップグレードをする前に<a href = '/en/release/5.0.0.html'>リリースノート</a>
                    と<a href = '/en/diff'>{{ site.html.ss }} 4との違い</a>を確認してください。
                    </strong>
                </p>
            </div>
        </div>
        <div class = 'text-center index-table'>
            <div class = 'row'>
                <div class = 'col-sm-4'>
                    <div class = 'spec-icon'>
                        <img src = '/static/images/icon/dinosaur-1.png'>
                        <h3 class = 'icon-caption'>Perl {{ site.sisimai.workson.perl[0] }}以上</h3>
                    </div>
                    <div class = 'index-info'>
                        <ul class = 'spec'>
                            <li>2つの依存モジュール</li>
                            <ul>
                                <li>
                                    <a href = 'https://metacpan.org/pod/Class::Accessor::Lite' target = 'new'>
                                        Class::Accessor::Lite
                                    </a>
                                </li>
                                <li><a href = 'https://metacpan.org/pod/JSON' target = 'new'>JSON</a></li>
                            </ul>
                        </ul>
                        <a href = '{{ site.sisimai.distribution.perl }}' class = 'btn btn-continue'>CPANからダウンロード</a>
                    </div>
                </div>

                <div class = 'col-sm-4'>
                    <div class = 'spec-icon'>
                        <img src = '/static/images/icon/ruby-1.png'>
                        <h3 class = 'icon-caption'>
                            Ruby {{ site.sisimai.workson.ruby[0] }} /
                            JRuby {{ site.sisimai.workson.jruby[0] }}以上
                        </h3>
                    </div>
                    <div class = 'index-info'>
                        <ul class = 'spec'>
                            <li>各依存Gem</li>
                            <ul>
                                <li><a href = 'https://rubygems.org/gems/oj' target = 'new'>Oj</a> (MRI)</li>
                                <li><a href = 'https://rubygems.org/gems/jrjackson' target = 'new'>JrJackson</a> (JRuby)</li>
                            </ul>
                        </ul>
                        <a href = '{{ site.sisimai.distribution.ruby }}' class = 'btn btn-continue'>RubyGemsからダウンロード</a>
                    </div>
                </div>

                <div class = 'col-sm-4'>
                    <div class = 'spec-icon'>
                        <img src = '/static/images/icon/golang-1.png'>
                        <h3 class = 'icon-caption'>Go {{ site.sisimai.workson.golang[0] }}以上</h3>
                    </div>
                    <div class = 'index-info'>
                        <ul class = 'spec'>
                            <li>v5.2.1から外部依存は無くなりました</li>
                            <ul>
                                <li>
                                    <a href = 'https://pkg.go.dev/golang.org/x/text/encoding' target = 'new'>
                                        <s>golang.org/x/text/encoding</s>
                                    </a>
                                </li>
                                <li>
                                    <a href = 'https://pkg.go.dev/golang.org/x/net/html/charset' target = 'new'>
                                        <s>golang.org/x/net/html/charset</s>
                                    </a>
                                </li>
                            </ul>
                        </ul>
                        <a href = '{{ site.sisimai.distribution.golang }}' class = 'btn btn-continue'>go get</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section> <!-- /#environment -->

<section id = 'install'>
    <div class = 'container'>
        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'post-it'>
                    <i class = 'fa fa-cloud-download-alt'></i>
                </div>
            </div>
            <div class = 'heading col-sm-8 col-sm-offset-0'>
                <h2 class = 'in-desc'>{{ site.html.ss }}をインストールする</h2>
                <p class = 'description'>
                    {{ site.html.ss }}は
                    <a href = '{{ site.sisimai.repository.project }}' target = 'new'>GitHub</a>,
                    <a href = '{{ site.sisimai.distribution.perl }}' target = 'new'>CPAN</a>, 
                    <a href = '{{ site.sisimai.distribution.ruby }}' target = 'new'>RubyGems.org</a>,
                    <a href = '{{ site.sisimai.distribution.golang }}' target = 'new'><kbd>go get</kbd></a>
                    からそれぞれダウンロード・インストールが可能です。

                    また、Perl版{{ site.html.ss }}は<a href = 'https://www.freshports.org/mail/p5-Sisimai/' target = 'new'>FreeBSDのportsコレクション</a>
                    や<a href = 'https://sources.debian.org/src/libsisimai-perl/' target = 'new'>Debianパッケージ</a>
                    からでもインストールすることができます。
                </p>
                <p class = 'description ja'>
                    <strong>
                    {{ site.html.ss }} 5.0.0で互換性のない、破壊的な変更がいくつか入っています。
                    インストールやアップグレードをする前に<a href = '/en/release/5.0.0.html'>リリースノート</a>
                    と<a href = '/en/diff'>{{ site.html.ss }} 4との違い</a>を確認してください。
                    </strong>
                </p>
            </div>
        </div>
        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-label'><i class = 'fab fa-git'></i></div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h3 class = 'in-desc'>GitHubから</h3>
                <p class = 'description ja'>
                    <img class = 'lhs' src = '/static/images/icon/github-1.png'>
                    開発版を含む最新バージョンと安定版の{{ site.html.ss }}は
                    <a href = '{{ site.sisimai.repository.project }}' target = 'new'>GitHub</a>
                    の<span class = 'value'>5-stable</span>ブランチまたは<span class = 'value'>4-stable</span>
                    ブランチからダウンロード出来ます。Perl版・Ruby版・Go版ともにこのリポジトリにあります。
                </p>
                <p class = 'description ja'>
                    2024年2月2日からリポジトリのデフォルトブランチは
                    <strong><span class = 'value'>5-stable</span></strong>になりました。
                </p>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-text'>Perl</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h4 class = 'in-desc'>Perl版{{ site.html.ss }} (v5)</h4>
                <p class = 'description ja'>
                    <img class = 'lhs' src = '/static/images/icon/dinosaur-1.png'>
                    Perl版{{ site.html.ss }}のリポジトリ名は
                    <a href = '{{ site.sisimai.repository.perl }}'><strong>sisimai/p5-sisimai</strong></a>
                    です。{{ site.html.ss }} 5.0.0から<strong>Perl 5.26以上が必要</strong>になりますので、
                    インストールの前にシステムに入っているPerlのバージョンを確認してください。
                </p>
                <pre class = 'prettyprint'>
% <kbd>perl -v</kbd>

This is perl 5, version 30, subversion 0 (v5.30.0) built for darwin-2level

Copyright 1987-2019, Larry Wall
...
                </pre>
                <pre class = 'prettyprint'>
% <kbd>git clone https://github.com/sisimai/p5-sisimai.git</kbd>
% <kbd>cd ./p5-sisimai</kbd>
% <kbd>make install-from-local</kbd>
./cpanm --sudo . || ( make cpm &amp;&amp; ./cpm install --sudo -v . )
--&gt; Working on .
Configuring Sisimai-v5.0.0 ... OK
Building and testing Sisimai-v5.0.0 ... Password: &lt;sudo password here&gt;
OK
Successfully installed Sisimai-v5.0.0
1 distribution installed

% <kbd>perl -MSisimai -lE 'print Sisimai-&gt;version'</kbd>
5.0.0
                </pre>

                <h4 class = 'in-desc'>古いバージョン (v4)</h4>
                <p class = 'description ja'>
                    2024年2月2日よりリポジトリのデフォルトブランチは<span class = 'value'>5-stable</span>
                    になっています。もし{{ site.html.ss }}を使いたい場合は<span class = 'value'>4-stable</span>
                    をブランチ名に指定してください。
                </p>
                <pre class = 'prettyprint'>
% <kbd>git clone -b 4-stable https://github.com/sisimai/p5-sisimai.git</kbd>
                </pre>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-text'>Ruby</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h4 class = 'in-desc'>Ruby版{{ site.html.ss }}</h4>
                <p class = 'description ja'>
                    <img class = 'lhs' src = '/static/images/icon/ruby-1.png'>
                    Ruby版{{ site.html.ss }}のリポジトリ名は
                    <a href = '{{ site.sisimai.repository.ruby }}'><strong>sisimai/rb-sisimai</strong></a>
                    です。{{ site.html.ss }} 5.0.0から<strong>Ruby 2.4以上が必要</strong>になりますので、
                    インストールの前にシステムに入っているRubyのバージョンを確認してください。
                </p>
                <pre class = 'prettyprint'>
% <kbd>ruby -v</kbd>
ruby 3.3.0 (2023-12-25 revision 5124f9ac75) [x86_64-darwin21]
                </pre>

                <pre class = 'prettyprint'>
% <kbd>git clone https://github.com/sisimai/rb-sisimai.git</kbd>
% <kbd>cd ./rb-sisimai</kbd>
% <kbd>sudo make depend install-from-local</kbd>
gem install bundle rake minitest
...
3 gems installed
if [ -d "/usr/local/jr" ]; then \
    PATH="/usr/local/jr/bin:$PATH" /usr/local/jr/bin/gem install bundle rake minitest; \
fi
...
3 gems installed
/opt/local/bin/rake install
sisimai 5.0.0 built to pkg/sisimai-5.0.0.gem.
sisimai (5.0.0) installed.
if [ -d "/usr/local/jr" ]; then \
    PATH="/usr/local/jr/bin:$PATH" /usr/local/jr/bin/rake install; \
fi
sisimai 5.0.0 built to pkg/sisimai-5.0.0-java.gem.
sisimai (5.0.0) installed.
                </pre>

                <h4 class = 'in-desc'>古いバージョン (v4)</h4>
                <p class = 'description ja'>
                    2024年2月2日よりリポジトリのデフォルトブランチは<span class = 'value'>5-stable</span>
                    になっています。もし{{ site.html.ss }}を使いたい場合は<span class = 'value'>4-stable</span>
                    をブランチ名に指定してください。
                </p>
                <pre class = 'prettyprint'>
% <kbd>git clone -b 4-stable https://github.com/sisimai/rb-sisimai.git</kbd>
                </pre>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-label'>go get</div>
                <div class = 'index-text'>Go</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h3 class = 'in-desc'>Go版{{ site.html.ss }}</h3>
                <p class = 'description ja'>
                    <img class = 'lhs' src = '/static/images/icon/golang-1.png' width = '80'>
                    Go版{{ site.html.ss }}は<kbd>go get</kbd>コマンドで <span class = 'value'>$GOMODCACHE</span>
                    へインストールされます。
                    <span class = 'value'>libsisimai.org/sisimai</span> には
                    <span class = 'value'>main</span> パッケージを宣言したファイルは入っていませんので
                    以下のようにディレクトリを作成して依存パッケージとして導入してください。
                </p>
            </div>
        </div>
        <div class = 'row'>
            <div class = 'col-sm-8 col-sm-offset-2'>
                <pre class = 'prettyprint'>$ <kbd>mkdir ./sisimai</kbd>
$ <kbd>cd ./sisimai</kbd>
$ <kbd>go mod init example.com/sisimaicli</kbd>
go: creating new go.mod: module example.com/sisimaicli

$ <kbd> go get -u libsisimai.org/sisimai/v5@latest</kbd>
go: added libsisimai.org/sisimai/v5 v5.4.0

$ <kbd>cat ./go.mod</kbd>
module example.com/sisimaicli

go 1.24

require (
	libsisimai.org/sisimai/v5 v5.4.0 // indirect
)
                </pre>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-label'>CPAN</div>
                <div class = 'index-text'>Perl</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h3 class = 'in-desc'>CPANから</h3>
                <p class = 'description ja'>
                    <img class = 'lhs' src = '/static/images/icon/dinosaur-1.png'>
                    Perl版{{ site.html.ss }}のリリース版のみ
                    <a href = '{{ site.sisimai.distribution.perl }}' target = 'new'>CPAN</a>
                    からダウンロードが可能です。<kbd>cpan</kbd>コマンドでもインストール出来ますが、
                    <a href = 'https://github.com/miyagawa/cpanminus' target = 'new'><kbd>cpanm</kbd></a>
                    コマンドや
                    <a href = 'https://github.com/skaji/cpm' target = 'new'><kbd>cpm</kbd></a>
                    を使うとPerlモジュールのインストールが非常に楽です。
                    <br />
                    <br />
                </p>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-8 col-sm-offset-2'>
                <pre class = 'prettyprint'>
% <kbd>cpanm --sudo Sisimai</kbd>
--&gt; Working on Sisimai
Fetching http://www.cpan.org/authors/id/A/AK/AKXLIX/Sisimai-5.0.0.tar.gz ... OK
...
1 distribution installed
% <kbd>perldoc -l Sisimai</kbd>
/usr/local/lib/perl5/site_perl/5.30.0/Sisimai.pm
                </pre>

                <p class = 'description ja'>
                    古いバージョンをインストールしたい場合は、以下のようにURLを指定してください。
                </p>
                <pre class = 'prettyprint'>
% <kbd>cpanm --sudo https://cpan.metacpan.org/authors/id/A/AK/AKXLIX/Sisimai-v4.25.16.tar.gz</kbd>
% <kbd>sudo cpm install https://cpan.metacpan.org/authors/id/A/AK/AKXLIX/Sisimai-v4.25.16.tar.gz</kbd>
                </pre>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-label'>gem</div>
                <div class = 'index-text'>Ruby</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h3 class = 'in-desc'>RubyGems.orgから</h3>
                <p class = 'description ja'>
                    <img class = 'lhs' src = '/static/images/icon/ruby-1.png'>
                    Ruby版{{ site.html.ss }}のリリース版のみ
                    <a href = '{{ site.sisimai.distribution.ruby }}' target = 'new'>RubyGems.org</a>
                    からダウンロードが可能で、<kbd>gem</kbd>コマンドでインストールが出来ます。
                    <br>
                    JRubyを使用する場合は<kbd>jgem</kbd>でのインストールも可能です。
                </p>
            </div>
        </div>
        <div class = 'row'>
            <div class = 'col-sm-8 col-sm-offset-2'>
                <pre class = 'prettyprint'>
% <kbd>sudo gem install sisimai</kbd>
Fetching: sisimai-5.0.0.gem (100%)
Successfully installed sisimai-5.0.0
Parsing documentation for sisimai-5.0.0
Installing ri documentation for sisimai-5.0.0
Done installing documentation for sisimai after 6 seconds
1 gem installed
                </pre>

                <p class = 'description ja'>
                    古いバージョンをインストールしたい場合は、以下のように<kbd>-v</kbd>オプションで
                    任意のバージョンを指定してください。
                </p>
                <pre class = 'prettyprint'>
% <kbd>sudo gem install sisimai -v 4.25.16</kbd>
                </pre>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-label'>Ports</div>
                <div class = 'index-text'>Perl</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h3 class = 'in-desc'>Portsコレクションから(FreeBSD)</h3>
                <p class = 'description ja'>
                    <img class = 'lhs' src = '/static/images/icon/freebsd-daemon-2.png'>
                    Perl版{{ site.html.ss }}は<a href = 'https://www.freebsd.org/ja/' target = 'new'>FreeBSD</a>
                    の<a href = 'https://www.freebsd.org/ja/ports/index.html' target = 'new'>Portsコレクション</a>
                    (<a href = 'https://www.freshports.org/mail/p5-Sisimai' target = 'new'>mail/p5-Sisimai)</a>
                    からインストールができます。<kbd>make</kbd>コマンド一発でインストールが可能ですが、
                    Perl版{{ site.html.ss }}がPortsコレクションに取り込まれるタイミングによっては、
                    最新版ではない{{ site.html.ss }}がインストールされる点に注意してください。
                </p>
            </div>
        </div>
        <div class = 'row'>
            <div class = 'col-sm-8 col-sm-offset-2'>
                <pre class = 'prettyprint'>
# <kbd>cd /usr/ports/mail/p5-sisimai</kbd>
# <kbd>make install</kbd>
===> License BSD2CLAUSE accepted by the user
===>  p5-sisimai-4.25.16 depends on file: /usr/local/sbin/pkg - found
=> Sisimai-v4.25.16.tar.gz doesn't seem to exist in /usr/ports/distfiles/.
...
                </pre>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-label'>apt</div>
                <div class = 'index-text'>Perl</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h3 class = 'in-desc'>Debianパッケージから</h3>
                <p class = 'description ja'>
                    <img class = 'lhs' src = '/static/images/icon/debian-2.png'>
                    Perl版{{ site.html.ss }}は<a href = 'https://www.debian.or.jp/' target = 'new'>Debian</a>
                    や<a href = 'https://jp.ubuntu.com/' target = 'new'>Ubuntu</a>の
                    <a href = 'https://sources.debian.org/src/libsisimai-perl/' target = 'new'>パッケージ</a>
                    (libsisimai-perl)からインストールができます。
                    <kbd>apt</kbd>コマンド一発でインストールが可能ですが、Perl版{{ site.html.ss }}
                    がパッケージに取り込まれるタイミングによっては、最新版ではない{{ site.html.ss }}
                    がインストールされる点に注意してください。
                </p>
            </div>
        </div>
        <div class = 'row'>
            <div class = 'col-sm-8 col-sm-offset-2'>
                <pre class = 'prettyprint'># <kbd>apt install libsisimai-perl</kbd>
Reading package lists... Done
Building dependency tree
Reading state information... Done
...
Need to get 366 kB/563 kB of archives.
After this operation, 1892 kB of additional disk space will be used.
Do you want to continue? [Y/n] <kbd>y</kbd>
Get:1 http://jp.archive.ubuntu.com/ubuntu focal/universe amd64 libclass-accessor-lite-perl all 0.08-1 [8136 B]
Get:2 http://jp.archive.ubuntu.com/ubuntu focal/universe amd64 libsisimai-perl all 4.25.5-1 [358 kB]
Fetched 366 kB in 2s (171 kB/s)
...
Setting up libjson-perl (4.02000-2) ...
Setting up libsisimai-perl (4.25.5-1) ...
Setting up libjson-xs-perl (4.020-1build1) ...
Processing triggers for man-db (2.9.1-1) ...
                </pre>
            </div>
        </div>

    </div>
</section> <!-- /#install -->

<section id = 'usage' class = 'parallax'>
    <div class = 'container'>
        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'post-it'>
                    <i class = 'fa fa-keyboard'></i>
                </div>
            </div>
            <div class = 'heading col-sm-8 col-sm-offset-0'>
                <h2>基本的な使い方</h2>
            </div>
        </div>
        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-label'>rise()</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h3 class = 'in-desc'>{{ site.html.ss }}のrise()メソッド</h3>
                <p class = 'description ja'>
                    <img class = 'lhs' src = '/static/images/icon/outline-1.png'>
                    下記のコードは{{ site.html.ss }}の<kbd>rise()</kbd>
                    メソッドを使ってバウンスメールを解析し解析結果のデータを得る例です。
                    <kbd>rise()</kbd>メソッドに指定できる他の引数については
                    <a href = '/ja/usage/'>シシマイでの解析方法</a>をご覧ください。
                    従来の<kbd>make()</kbd>メソッドは{{ site.html.ss }} 5.0.0で廃止になりました。
                </p>
            </div>
        </div>
        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-text'>Perl</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h4 class = 'in-desc'>Perl版{{ site.html.ss }}</h4>
                <pre class = 'prettyprint'><span class = 'shebang'>#! /usr/bin/env perl</span>
use Sisimai;
my $v = Sisimai-&gt;rise('/path/to/mbox'); # or Path to Maildir

if( defined $v ) {
    for my $e ( @$v ) {
        print $e->addresser->address;   # "michitsuna@example.org" # From
        print $e->recipient->address;   # "kijitora@example.jp"    # To
        print $e->recipient->host;      # "example.jp"
        print $e->deliverystatus;       # "5.1.1"
        print $e->replycode;            # "550"
        print $e->reason;               # "userunknown"
        print $e->origin;               # "/var/spool/bounce/new/1740074341.eml"
        print $e->hardbounce;           # 1
    }
} else {
    # There is no bounce message in the mailbox
    # or Sisimai could not decode
}
                </pre>
            </div>
        </div>
        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-text'>Ruby</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h4 class = 'in-desc'>Ruby版{{ site.html.ss }}</h4>
                <pre class = 'prettyprint'><span class = 'shebang'>#! /usr/bin/env ruby</span>
require 'sisimai'
v = Sisimai.rise('/path/to/mbox') # or Path to Maildir

if v.is_a? Array
  v.each do |e|
    puts e.class                # Sisimai::Fact
    puts e.recipient.class      # Sisimai::Address
    puts e.timestamp.class      # Sisimai::Time

    puts e.addresser.address    # "michitsuna@example.org" # From
    puts e.recipient.address    # "kijitora@example.jp"    # To
    puts e.recipient.host       # "example.jp"
    puts e.deliverystatus       # "5.1.1"
    puts e.replycode            # "550"
    puts e.reason               # "userunknown"
    puts e.origin               # "/var/spool/bounce/Maildir/new/1740074341.eml"
    puts e.hardbounce           # true
  end
else
  # There is no bounce message in the mailbox
  # or Sisimai could not decode
end
                </pre>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-text'>Go</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h4 class = 'in-desc'>Go版{{ site.html.ss }}</h4>
                <p class = 'description ja'>
                    <img class = 'lhs' src = '/static/images/icon/golang-1.png' width = '80'>
                    下記のコードは{{ site.html.ss }}の<kbd>Rise()</kbd>
                    関数を使ってバウンスメールを解析し解析結果のデータを得る例です。
                    <kbd>Rise()</kbd>関数に指定できる他の引数については
                    <a href = '/ja/usage/'>シシマイでの解析方法</a>をご覧ください。
                </p>
                <p class = 'description ja caution'>
                    {{ site.html.ss }} 5.4.0から<kbd>Rise()</kbd>関数はポインターではなく
                    スライスを返すようになりました。
                </p>

                <pre class = 'prettyprint'>$ <kbd>vi ./sisid.go</kbd></pre>
                <pre class = 'prettyprint'><span class = 'shebang'>package main</span>
import "os"
import "fmt"
import "libsisimai.org/sisimai/v5"

func main() {
	path := os.Args[1]     // go run ./sisid /path/to/mailbox or maildir/
	args := sisimai.Args() // siba.DecodingArgs{}

	// sisi is a pointer to []siba.Fact
	sisi, nyaan := sisimai.Rise(path, args)
	if len(sisi) &gt; 0 {
		for _, e := range sisi {
			// e is a siba.Fact struct
			fmt.Printf("- Sender is %s\n", e.Addresser.Address)
			fmt.Printf("- Recipient is %s\n", e.Recipient.Address)
			fmt.Printf("- Recipient host is %s\n", e.Recipient.Host)
			fmt.Printf("- Delivery status is %s\n", e.DeliveryStatus)
			fmt.Printf("- SMTP reply code is %s\n", e.ReplyCode)
			fmt.Printf("- Bounced due to %s\n", e.Reason)
			fmt.Printf("- Email file is %s\n", e.Origin)
			fmt.Printf("- Hard bounce is %t\n", e.HardBounce)
		}
	}
	// nyaan is a pointer to []siba.NotDecoded
	if len(nyaan) &gt; 0 { fmt.Fprintf(os.Stderr, "%v\n", nyaan) }
}
                </pre>

                <pre class = 'prettyprint'>$ <kbd>CGO_ENABLED=0 go build -o ./sisid ./sisid.go</kbd>
$ <kbd>./sisid /path/to/mailbox</kbd>
                </pre>

            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'post-it'>
                    <i class = 'fa-solid fa-code'></i>
                </div>
            </div>
            <div class = 'heading col-sm-8 col-sm-offset-0'>
                <h2>JSONで出力する</h2>
            </div>
        </div>
        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-label'>dump()</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h3 class = 'in-desc'>{{ site.html.ss }}のdump()メソッド</h3>
                <p class = 'description ja'>
                    <img class = 'lhs' src = '/static/images/icon/purchase-order-1.png'>
                    Perl版{{ site.html.ss }} v4.1.27から登場した<kbd>dump()</kbd>メソッドは解析結果を
                    JSONで得るのに便利です。下記のように解析したいメールのPATHを渡すだけの
                    簡単なコードで済みます。
                </p>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-text'>Perl</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h4 class = 'in-desc'>Perl版{{ site.html.ss }}</h4>
                <pre class = 'prettyprint'><span class = 'shebang'>#! /usr/bin/env perl</span>
use Sisimai;
print Sisimai-&gt;dump('/home/postmaster/Maildir/cur');
                </pre>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-text'>Ruby</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h4 class = 'in-desc'>Ruby版{{ site.html.ss }}</h4>
                <pre class = 'prettyprint'><span class = 'shebang'>#! /usr/bin/env ruby</span>
require 'sisimai'
puts Sisimai.dump('/home/postmaster/Maildir/cur')
                </pre>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-text'>Go</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h4 class = 'in-desc'>Go版{{ site.html.ss }}</h4>
                <pre class = 'prettyprint'><span class = 'shebang'>package main</span>
import "fmt"
import "libsisimai.org/sisimai/v5"

func main() {
	args := sisimai.Args()
	json, _ := sisimai.Dump("/home/postmaster/Maildir/cur", args)
	if json != nil &amp;&amp; *json != "" { fmt.Printf("%s\n", *json)   }
}
                </pre>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-label'>jq</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h3 class = 'in-desc'>&quot;jq&quot;コマンドと組み合わせる</h3>
                <p class = 'description ja'>
                    <img class = 'lhs' src = '/static/images/icon/js-1.png'>
                    解析結果のJSONデータを目で確認したい場合は
                    <a href = 'https://stedolan.github.io/jq/' target = 'new'><kbd>jq</kbd></a>コマンドが便利です。
                    下記のように<kbd>dump()</kbd>メソッドの出力が読みやすく表示されます。
                </p>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-text'>Perl</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h4 class = 'in-desc'>Perl版{{ site.html.ss }}</h4>
                <pre class = 'prettyprint'>
% <kbd>perl -MSisimai -lE 'print Sisimai-&gt;dump(shift)' path/to/mbox | jq .</kbd>
                </pre>
                <img src = '/static/images/demo/sisimai-5-cli-dump-p01.gif' width = '100%'>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-text'>Ruby</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h4 class = 'in-desc'>Ruby版{{ site.html.ss }}</h4>
                <pre class = 'prettyprint'>
% <kbd>ruby -rsisimai -e 'puts Sisimai.dump($*.shift)' path/to/mbox | jq .</kbd>
                </pre>
                <img src = '/static/images/demo/sisimai-5-cli-dump-r01.gif' width = '100%'>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-text'>Go</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h4 class = 'in-desc'>Go版{{ site.html.ss }}</h4>
                <pre class = 'prettyprint'>% <kbd>go build -o sisid ./sisid.go &amp;&amp; ./sisid path/to/mbox | jq .</kbd>
                </pre>
                <img src = '/static/images/demo/sisimai-5-cli-dump-g01.gif' width = '100%'>
            </div>
        </div>

        <div class = 'row'>
            <div class = 'col-sm-1 col-sm-offset-1'>
                <div class = 'index-text'>JSON</div>
            </div>
            <div class = 'col-sm-8 col-sm-offset-0'>
                <h4 class = 'in-desc'><strong>jq</strong>でJSONを見やすくした例</h4>
                <pre class = 'prettyprint'>[
  {
    "destination": "google.example.com",
    "lhost": "gmail-smtp-in.l.google.com",
    "hardbounce": 0,
    "reason": "authfailure",
    "catch": null,
    "command": "DATA",
    "addresser": "michitsuna@example.jp",
    "alias": "nekochan@example.co.jp",
    "decodedby": "Postfix",
    "senderdomain": "example.jp",
    "listid": "",
    "action": "failed",
    "feedbacktype": "",
    "messageid": "hwK7pzjzJtz0RF9Y@relay3.example.com",
    "origin": "./gmail-5.7.26.eml",
    "recipient": "kijitora@google.example.com",
    "rhost": "gmail-smtp-in.l.google.com",
    "subject": "Nyaan",
    "timezoneoffset": "+0900",
    "replycode": 550,
    "token": "84656774898baa90660be3e12fe0526e108d4473",
    "diagnostictype": "SMTP",
    "timestamp": 1650119685,
    "diagnosticcode": "host gmail-smtp-in.l.google.com[64.233.187.27] said: This mail has been blocked because the sender is unauthenticated. Gmail requires all senders to authenticate with either SPF or DKIM. Authentication results: DKIM = did not pass SPF [relay3.example.com] with ip: [192.0.2.22] = did not pass For instructions on setting up authentication, go to https://support.google.com/mail/answer/81126#authentication c2-202200202020202020222222cat.127 - gsmtp (in reply to end of DATA command)",
    "deliverystatus": "5.7.26"
  }
]
                </pre>
            </div>
        </div>
    </div>
</section> <!-- #usage -->

